# 路书制作工具

路书制作工具是一个基于网页的地图标记和路线规划工具，允许用户在地图上添加标记点、连接路线，并导出分享您的行程规划。

## 项目简介

这是一个完全基于前端的路书制作工具，使用HTML、CSS和JavaScript构建，结合Leaflet地图库实现真实地图操作。用户可以在这个工具中创建、编辑和分享路线规划。

## 功能特性

- **地图操作**: 支持多种地图源（OpenStreetMap、高德地图、Google地图、卫星图等）
- **标记点管理**: 添加、编辑、删除标记点，支持自定义图标和颜色
- **路线连接**: 连接标记点，支持多种交通方式（汽车、火车、地铁、飞机、步行）
- **时间规划**: 为标记点和连接线添加时间信息，支持多时间点
- **智能搜索**: 支持多种搜索方式（Photon、Nominatim、Overpass）
- **数据导入导出**: 支持JSON格式的路书导入导出
- **HTML导出**: 可导出为独立的HTML文件，包含完整地图信息，支持导入导出
- **本地存储**: 自动保存到本地存储，刷新后数据不丢失
- **快捷键支持**: 支持A、C、D、F、H、?、/等多种快捷键
- **撤销功能**: 支持Ctrl+Z撤销操作
- **日期分组**: 按日期对标记点进行分组显示
- **实时预览**: 在地图上实时显示标记点、连接线和路线
- **响应式设计**: 适配不同屏幕尺寸

## 使用方法

### 基本操作

1. **添加标记点**:
   - 点击工具栏"添加标记点"按钮或按 `A` 键
   - 在地图上点击以放置标记点
   - 编辑标记点详细信息（名称、时间、图标、标注等）

2. **连接标记点**:
   - 点击工具栏"连接标记点"按钮或按 `C` 键
   - 选择起始点和目标点并连接
   - 选择交通方式，设置时间、耗时等信息

3. **搜索地点**:
   - 在搜索框输入地点名称
   - 可选择不同的搜索方式（自动分配、Photon、Nominatim、Overpass）

4. **数据管理**:
   - 点击"导出JSON"保存路书数据
   - 点击"导入路书"加载已保存的数据
   - 点击"导出HTML"生成可分享的独立HTML文件

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| `A` | 添加标记点模式 |
| `C` | 打开连接标记点界面 |
| `D` | 删除选中的标记点或连接线 |
| `F` | 自动调整视窗以显示所有元素 |
| `H` / `?` | 显示帮助面板 |
| `/` | 聚焦到搜索框 |
| `Ctrl` + `Z` | 撤销上一步操作 |

### 地图源选择

- OpenStreetMap
- ESRI卫星图
- 高德地图
- 高德卫星图
- Google地图
- Google卫星图

## 技术架构

- **前端框架**: 纯JavaScript（无框架依赖）
- **地图库**: Leaflet
- **地图数据**: OpenStreetMap、高德地图、Google地图等
- **存储方式**: 浏览器本地存储（localStorage）
- **导出格式**: JSON、HTML

## 文件说明

- `index.html`: 主页面文件
- `script.js`: 主要应用逻辑
- `style.css`: 样式文件
- `html_export.js`: HTML导出功能实现
- `talk.md`: 项目需求文档
- `README.md`: 项目说明文档

## TODO

- 适配手机端体验
- 搜索优化
- 重构成 vue 模式 提高扩展性
- 添加后台系统,保存加载列表
- 支持黑暗模式
